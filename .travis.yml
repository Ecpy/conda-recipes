language: generic

env:
  global:
    secure: "AyaI9ymEvpdxeK6qaD/pHaJ93ITmA0PkoA7u13BfjwZhxyVLSLaOKQXlND+SWv973CzJ/40kgreXnexe/F5E13EvCtWf/j+kZL5FrAT/Lntt41vTHEJJ+IbVptD0S9ymwW5yyfrLlISj98pmQtjI5a8e/QHHLcILswLciGYpVHhVeaXEGmhaoy2qbrom3d+i9y1FyxUYMblPWKBUN2KE6ufwFq4q3PO6twR8Rda5xWelUfkWRVMXXCYuPJMzUwPJi6jsrU21D9HVgu0NZW1/ISbAM3lYqfXVPWxNS1z3dxRT3rB1rcW3bB1DPQTpHdXCf8B6FTQn91as2JdoQuC2VXrJ4Ph230r8C39gfdNM3QyZZdat8wMDtaelV5387IRIpxXQpNfFA7S/WN5BRpSTmO4lBSECgzQpZJ+4oOC12kn4GyUjkTRg4wXbfH1/eboahEJ5uni/VKKePoHkh+f8e2CJUgJ2BGa/U/rEPNweBefYVxVLvgCvJLfbIz1Bl7A2VWPyP9S0i29zaZyEvyY+qrdrDfoGmm7/lP1aUd0ezQUEuaDW2Ksy1lpTVmBxYcfzLB29SeC2Mg5darClNTWjB8/vJ3/g5GItzwZhoqnHPF+H1NE956x9EYeNsSu2jtmTbGlHiEeaS0EiaGgCQDIvCQxlnXFK0jy359k35sbCqik="

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: false
      env: python=2.7 CONDA_PY=27
    - os: linux
      dist: trusty
      sudo: false
      env: python=3.4 CONDA_PY=34
    - os: linux
      dist: trusty
      sudo: false
      env: python=3.5 CONDA_PY=35
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=27
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=34
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=35

before_install:
  - export TRAVIS_COMMIT_MSG="$(git log --format=%B --no-merges -n 1)"
  - echo "$TRAVIS_COMMIT_MSG" | grep '[argh]'; export BUILD_ARGH=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[pathtools]'; export BUILD_PATHTOOLS=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[watchdog]'; export BUILD_WATCHDOG=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[atom]'; export BUILD_ATOM=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[kiwisolver]'; export BUILD_KIWISOLVER=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[enaml]'; export BUILD_ENAML=$?; true

install:
  - source continuous-integration/travis/install.sh
  - mkdir conda-bld-out
  - cd conda-bld-out
  - export CONDA_BLD_PATH=$(pwd)
  - cd ..
  - conda config --add channels ecpy

script:
  - source continuous-integration/travis/build-packages.sh

after_success:
  - cd conda-bld-out
  - if [ TRAVIS_SECURE_ENV_VARS ]; then python ../continuous-integration/anaconda-push.py; fi
