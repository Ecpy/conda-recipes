language: generic

env:
  global:
    secure: ff27W1AGW4xkyDM6sv3g8qzrN1N6dSWvXoqsQ1yF6Bgxa+p2A9clIJMAcgc4n6bCxxw9/zuBHbSjd9f070IsNV7JNGlYev6pNBMxjZgtgNSVvwCku0q3MrjM5sYT5HBBmgv0QNh5RCK2uOOgwju89N/vCrOAyGtbd2kEacIjduRtJq5fWt/NDjMxtl1sE4Dj5g/NnmQJIn02vhpFywma0VFZA5+e7EIpT6pvNsc55zmEjwqoPnZmAOYF6reWkFtbBc11bvKtZKRyac7+hsNoHCW6xs5mz5BOgtsE7fD+5yuf9C4yGaa/THrPHi0jkJu3oY5f9e2HW7J9gx96zH1IYcUbw5JcV0v2LMbGoly4xFopcrfiPVT+1RY9nF139Bx02+5l5nqmIa5FoiNaZms6o+5xkWp0tkNDOJCFzO+rvsuNUTJKJ7pLSpt2v0nAA/OW6PW5k2aOUZJZsiINU2oQ511s0r6SoCA+FTLsvK+WzBnmL8uc3+oRyFsEQMA9NOjqiblre5IvPY74dcOgvxL5chF9AbvkG3naFz4SLKecEa/F1Yr/CltpYLAyHSvA2xC1M3G7mBqjwF0ycte+FEX41DxjhgrYNKrnDfIVYiCmBsvrKK43uDtCBmfNF3PlAbsXvn7ApYJE0AO1BzqSPhUW/qFUw6O3moIfbhp9xwHyeos=

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: false
      env: python=2.7 CONDA_PY=27
    - os: linux
      dist: trusty
      sudo: false
      env: python=3.4 CONDA_PY=34
    - os: linux
      dist: trusty
      sudo: false
      env: python=3.5 CONDA_PY=35
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=27
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=34
    - os: osx
      osx_image: xcode7.3
      env: CONDA_PY=35

before_install:
  - export TRAVIS_COMMIT_MSG="$(git log --format=%B --no-merges -n 1)"
  - echo "$TRAVIS_COMMIT_MSG" | grep '[argh]'; export BUILD_ARGH=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[pathtools]'; export BUILD_PATHTOOLS=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[watchdog]'; export BUILD_WATCHDOG=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[atom]'; export BUILD_ATOM=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[kiwisolver]'; export BUILD_KIWISOLVER=$?; true
  - echo "$TRAVIS_COMMIT_MSG" | grep '[enaml]'; export BUILD_ENAML=$?; true

install:
  - source continuous-integration/travis/install.sh
  - mkdir conda-bld-out
  - cd conda-bld-out
  - export CONDA_BLD_PATH=$(pwd)
  - cd ..
  - conda config --add channels ecpy

script:
  - source continuous-integration/travis/build-packages.sh

after_success:
  - cd conda-bld-out
  - if [ TRAVIS_SECURE_ENV_VARS ]; then python ../continuous-integration/anaconda-push.py; fi
